---
layout: post
title: mail server for testing
date: 2016-08-03 23:12:51.000000000 +02:00
type: post
published: true
categories: []
tags: []
---
<h3>Set up a mail server</h3>
<p>Create a <span style="text-decoration:underline;">docker-compose.yml</span>:</p>
<pre>version: '2'

services:
 mail:
 image: tvial/docker-mailserver:latest
 # build: .
 hostname: mail
 domainname: domain.com
 container_name: mail
 ports:
 - "25:25"
 - "143:143"
 - "587:587"
 - "993:993"
 volumes:
 - maildata:/var/mail
 - ./config/:/tmp/docker-mailserver/

volumes:
 maildata:
 driver: local</pre>
<p>Create your mail accounts</p>
<pre>mkdir -p config
docker run --rm \
 -e MAIL_USER=user1@domain.tld \
 -e MAIL_PASS=mypassword \
 -ti tvial/docker-mailserver:latest \
 /bin/sh -c 'echo "$MAIL_USER|$(doveadm pw -s SHA512-CRYPT -u $MAIL_USER -p $MAIL_PASS)"' &gt;&gt; config/postfix-accounts.cf</pre>
<p>Start the container:</p>
<pre>docker-compose up -d mail</pre>
<p>Source: <a href="https://github.com/tomav/docker-mailserver">https://github.com/tomav/docker-mailserver</a></p>
<p>Alternative: <a href="https://poste.io/open">https://poste.io/open</a></p>
<h3>Send a mail (SMTP)</h3>
<p>Install <a href="http://brew install sendemail">sendemail</a> to send a mail:</p>
<pre>sendemail -f user1@domain.tld -t user1@domain.tld -u test2 -m content -s 0.0.0.0:25 -o tls=no</pre>
<p>&nbsp;</p>
<p>Alternatives in <a href="http://tecadmin.net/ways-to-send-email-from-linux-command-line">this article</a>.</p>
<h3>Read a mail (IMAP)</h3>
<p>Install <em>mutt</em> (<a href="http://www.lucianofiandesio.com/getting-started-with-mutt-on-osx">howto</a>) client. Create ~/.muttrc file as following:</p>
<pre>set my_server = 0.0.0.0
set my_smtp_server = 0.0.0.0
set my_user = user1@domain.tld
set my_pass = mypassword

# Account - SMTP

set smtp_url = "smtp://$my_user:$my_pass@$my_smtp_server:587"
set smtp_pass = $my_pass
set imap_user = $my_user
set imap_pass = $my_pass
set ssl_force_tls = yes
set ssl_starttls = no
set ssl_verify_host = no
set ssl_verify_dates = no


#
# Default inbox
#
set spoolfile=imaps://$my_server/INBOX

#
# Default location of mailboxes
#
set folder=imaps://$my_server/INBOX

bind index G imap-fetch-mail
#bind index d purge-message</pre>
<p>Start <em>mutt</em> to retrieve the mails via smtp, press G to check for updates.</p>
